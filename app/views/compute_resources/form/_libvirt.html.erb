<%= text_f f, :url, :label => "URL", :class => "input-xlarge", :help_block => "e.g. qemu://host.example.com/system" %>

<% hypervisor = f.object.hypervisor.uuid rescue nil%>
<% if hypervisor %>
  <%= f.hidden_field :uuid, :value => hypervisor %>
<% end %>

<%= link_to("Test Connection", "#", :class => "btn + #{hypervisor.nil? ? "" : "btn-success"}", :onclick => "testConnection(this)", :remote => true, :'data-url' => test_connection_compute_resources_path
       ) +
      image_tag('spinner.gif', :id => 'test_connection_indicator', :class => 'hide').html_safe
  %>